# Testing setup

# Testing support - GTest / GMock
set(GMOCK_DIR ${PROJECT_SOURCE_DIR}/../third_party/cpp/gmock)
set(GTEST_DIR ${PROJECT_SOURCE_DIR}/../third_party/cpp/gtest)
set(TEST_INCLUDES 
  ${GTEST_DIR}
  ${GTEST_DIR}/include
  ${GMOCK_DIR}
  ${GMOCK_DIR}/include
)
include_directories(${TEST_INCLUDES})

# GoogleTest
cpp_library(gtest
    ${GTEST_DIR}/src/gtest.cc
    ${GTEST_DIR}/src/gtest-death-test.cc
    ${GTEST_DIR}/src/gtest-filepath.cc
    ${GTEST_DIR}/src/gtest-port.cc
    ${GTEST_DIR}/src/gtest-test-part.cc
    ${GTEST_DIR}/src/gtest-typed-test.cc
)

# Building GTests
macro(cpp_gtest TARGET)
  cpp_executable(${TARGET})
  add_test(gtest_${TARGET} ${TEST_ROOT}/${TARGET})
  target_link_libraries(${TARGET} gtest)
endmacro(cpp_gtest)

# build_tests
function(build_tests)
  enable_testing()
  option(TESTING "Turn on testing." on)
endfunction()