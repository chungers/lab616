<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/REC-html4/strict.dtd">
<!-- saved from url=(0062)http://www.corp.google.com/eng/doc/important-abstractions.html -->
<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">

<LINK rel="stylesheet" type="text/css" href="./Overview of Important Abstractions and Data Structures_files/docstyle.css">
<STYLE type="text/css">
  h1 {
    text-align: left;
    font-size: 24;
    margin-left: -0.5in;
  }
</STYLE>

<TITLE>Overview of Important Abstractions and Data Structures</TITLE>
<SCRIPT type="text/javascript">
  _uacct="UA-18021-2";
  urchinTracker();

</SCRIPT>
</HEAD><BODY>

<H1><A name="overview_of_important_abstractions_and_data_structures">Overview of Important Abstractions and Data Structures</A></H1>

<ADDRESS>
Jeff Dean<BR>
Last Modified
    <SCRIPT type="text/javascript">
	<!--
	var lm = new Date(document.lastModified);
	document.write(lm.toDateString());
	//-->
    </SCRIPT>Mon Apr 27 2009
</ADDRESS>

<P>
This document is a very simple guide listing some of the most
important data structures and abstractions in the Google code base.
The Google code base is relatively large, and this guide is meant to
give new engineers an overview of what abstractions already exist,
to keep them from reinventing things that can be solved by already
existing code.
If you're looking for a list of more architecture-y Google things,
you might want to see the 
<A href="http://wiki/Main/GdhDeveloperHandbook">Google Developer Handbook</A>.

</P><P>
Some of the most commonly used abstractions are in <B>bold</B>.
</P><P>
<B>Important: If you have developed abstractions or libraries of code
that you think are generally applicable to a variety of problems
(i.e. aren't specific to just a single project, and would be good to
tell new employees about), please add an entry to this file. </B>

</P><P>
We also have a growing number of <A href="https://www.corp.google.com/~engdocs/java/">Java classes and libraries</A>, which are documented using JavaDoc.
</P><P>

</P><HR>

<!-- begin_autotoc -->
<!-- Automatically generated by autotoc.pl -->
<H2>Table of Contents</H2>
<OL>
<LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#general_data_structures_and_abstractions">General Data Structures and Abstractions</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#threads_and_synchronization">Threads and Synchronization</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#general_libraries_and_miscellaneous_routines_classes">General Libraries and Miscellaneous Routines/Classes</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#compression">Compression</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#math">Math</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#stats">Stats</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#file_input_output_abstractions">File Input/Output Abstractions</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#networking_abstractions">Networking Abstractions</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#string_matching">String Matching</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#document_web_http_html_specific_classes">Document/Web/HTTP/HTML Specific Classes</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#index_specific_abstractions">Index-specific Abstractions</A>
</LI><LI><A href="http://www.corp.google.com/eng/doc/important-abstractions.html#utility_programs">Utility Programs</A>
</LI></OL>
<!-- end_autotoc -->

<HR>


<H1><A name="datastruct"></A><A name="general_data_structures_and_abstractions">General Data Structures and Abstractions</A></H1>

<DL>
<DT><B><A name="sstable"></A><A name="sstablebuilder"></A>
    <CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/sstable/public/sstable.h">SSTable</A></CODE></B></DT>
<DT><B><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/sstable/public/sstable.h">SSTableBuilder</A></CODE></B></DT>

<DD><B>A persistent table that maps from strings to strings.  The keys are in
sorted order.  Does prefix delta encoding to keep the key strings
fairly compact. <CODE>SSTables</CODE> are read-only, and are
constructed using the <CODE>SSTableBuilder</CODE> interface.  The
classes <CODE>StringTable</CODE> and <CODE>StringTableBuilder</CODE>
are older, slower, and less flexible versions of these classes.  In
other words, use <CODE>SSTable</CODE>, not <CODE>StringTable</CODE>.
(<A href="https://www.corp.google.com/eng/designdocs/infrastructure/sstable.html">SSTable design doc</A>)</B></DD>
<BR>
<DT><A name="sortedmap"></A><A name="mutablesortedmap"></A><A name="mergedsortedmap"></A>
    <CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/sortedmap/sorted-map.h">SortedMap</A></CODE></DT>
<DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/sortedmap/mutable-sorted-map.h">MutableSortedMap</A></CODE></DT>
<DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/sortedmap/merged-sorted-map.h">MergedSortedMap</A></CODE></DT>
<DD><A href="http://moma/eng/designdocs/infrastructure/sorted-map/GUIDE_sorted-map.html">(design doc)</A>
A general data structure for a map from a 64-bit key
to an arbitrary set of data.  Can be used for both disk-based data
structures as well as in-memory data structures.  Persistent maps
are constructed using
<CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/sortedmap/sorted-map-builder.h">
SortedMapBuilder</A></CODE>.
<P>
<I>You should consider using <CODE>SSTable</CODE>s in preference to
  <CODE>SortedMap</CODE>s.  <CODE>SSTable</CODE>s are more general (supporting
  any key length), perform at least as well, and are supported by a wider
  variety of Google tools.</I></P></DD>
<BR>

<DT><A name="samplingtable"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/stats/util/sampling-table-inl.h">SamplingTable</A></CODE></DT>
<DD>
An abstraction for maintaining a mapping from keys to frequency
information about each key.  It differs from a hash table in that you
specify a maximum number of keys (<CODE>N</CODE>) to keep information
about, and it will ensure that the table never gets above that size
but that the data maintained closely approximates the most frequent
keys and their count values.  It does so by internally doing sampling
if the number of keys it knows about grows above <CODE>N</CODE>.  As
the number of distinct keys in the universe grows, it will keep
halving its sampling rate to ensure that the number of keys it needs
to keep information about remains below <CODE>N</CODE>.  As an
example, this is very useful if you're trying to keep track of the
most frequently occurring 10,000 words in a large corpus, and
maintaining data for every unique word would be way too much data.</DD>
<BR>

<DT><A name="fpcache"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/cache/fpcache.h">FpCache</A></CODE></DT>
<DD>An abstraction for maintaining a cache from 64-bit keys to arbitrary
	  data with a pseudo-LRU eviction policy.  Often useful on top of a <CODE>SortedMap</CODE> or
	  other large disk-based data structure with a relatively
	  small working set (e.g. the disk-based index lexicon uses a
	  200 MB or so <CODE>FpCache</CODE> on top of the 30 GB lexicon data
	  structures and gets a 99% hit rate).</DD>
<BR>

<DT><A name="sparsebitmap"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/bitmap/sparse-bitmap.h">SparseBitmap</A></CODE></DT>
<DD>A sparse bitmap representation (i.e. large holes without any bits
	  set don't take up much space).</DD>
<BR>

<DT><A name="smallintset"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/set/smallintset.h">SmallIntSet</A></CODE></DT>
<DD>A class to maintain and manipulate small sorted sets of integers.</DD>
<BR>

<DT><A name="dense_hash_set"></A><A name="dense_hash_map"></A><A name="sparse_hash_set"></A><A name="sparse_hash_map"></A>
    <CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/gtl/dense_hash_set.h">dense_hash_set&lt;T&gt;</A></CODE></DT>
<DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/gtl/dense_hash_map.h">dense_hash_map&lt;K, V&gt;</A></CODE></DT>
<DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/gtl/sparse_hash_set.h">sparse_hash_set&lt;T&gt;</A></CODE></DT>
<DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/gtl/sparse_hash_map.h">sparse_hash_map&lt;K, V&gt;</A></CODE></DT>
<DD>(Almost-)plug-compatible replacements for the STL
	  <CODE>hash_map</CODE> and <CODE>hash_set</CODE>
	  abstractions.  The sparse versions are very space efficient
	  (typically 2-3% space overhead beyond the data in the hash
	  table, using a clever encoding of the buckets that
	  uses only two bits for empty buckets), and the dense
	  versions are somewhat faster and sometimes more memory
	  efficient than the STL versions, because they represent the
	  data directly in the buckets, rather than using chaining.
          (<A href="http://www.corp.google.com/eng/howto/infrastructure/sparse_hash_map.html">more
          details</A>).</DD>
<BR>

<DT><A name="splitsorter"></A><A name="mergesorter"></A>
    <CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/sorting/sorter2.h">SplitSorter/MergeSorter</A></CODE></DT>
<DD>Interfaces for disk-based sorting and merging. This module can be used to 
sort simple data structures, or instances of any abstract data type. Direct versions
(DirectMergeSorter, DirectSplitSorter) handle simple data types efficiently, while
the indirect (pointer based) versions (IndirectMergeSorter, IndirectSplitSorter)
handle more complex structures. In general, you should usually use a merge sorter
and not a split sorter, unless your keys are fingerprints.</DD>
<BR>

<DT><A name="recordsorter"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/sorting/recordsorter.h">
RecordSorter</A></CODE></DT>
<DD>Interfaces for disk-based sorting and merging of
serialized records.
Unlike
<CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/sorting/sorter2.h">SplitSorter/MergeSorter</A></CODE>
which work on C++ objects,
this module assumes that each record is a self-contained byte-sequence.
In other words,
if the C++ class is not a "Plain Old Data Type",
the user has to serialize it.
In exchange for the inconveniences of the serialization requirement,
this module makes maximum use of the sorting memory buffer,
especially for variable-sized records. Other features include
support for checkpointing, distributed merging, counting/accumulating 
in merging.
</DD>
<BR>

<DT><A name="ezsorter"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/sorting/ezsorter.h">
EZSorter</A></CODE></DT>
<DD>This is a non-template simplified interface to 
<CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/sorting/recordsorter.h">
RecordSorter</A></CODE>.</DD>
<BR>

<DT><A name="interntable"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/strings/interntable.h">InternTable</A></CODE></DT>

<DD>A simple abstraction of a set of C-style strings for which each
unique string appears in memory exactly once.  By sharing memory of
same-valued strings, we reduce memory consumption when the same
string is used repeatedly.  Also, when using interned <CODE>char
*</CODE>s, comparing equality of two strings is reduced to a very fast
pointer comparison.</DD>
<BR>


<DT><A href="http://moma/eng/howto/infrastructure/mapreduce-basics.html"><B>MapReduce documentation</B></A>
</DT><DT><A name="mapreduce"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/mapreduce/public/mapreduce.h"><B>MapReduce</B></A></CODE>

</DT><DD><B>MapReduce is a library that makes it easier to write software to
process large amounts of data in parallel on lots of machines, without
the user having to worry excessively about the details of
parallelization or distribution. It's designed to make it easy to to
process each logical record in some input data (in a variety of
formats, including text files, repository files, sorted maps,
gzipped-text files, record IO files, etc.) to produce some output data
(key/value pairs), and then want to sort that output key/value pairs
(and apply a combining function for values that share the same key).</B></DD>
<BR>


<DT><A name="simplelrucache"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/cache/simple-lru-cache-inl.h">SimpleLRUCache</A></CODE></DT>
<DD>Generic LRU cache that maps from keys to values and has a fixed maximum
size.  Keys are evicted to meet the size constraint, and optionally also
to meet an idle-time constraint.</DD>
<BR>

<DT><A name="existencefilter"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/existencefilter/public/existence_filter.h">ExistenceFilter</A></CODE></DT>
<DD>Compact set representation that allows membership tests that can
give false positives, but not false negatives.  This is an
implementation of
<A href="http://www.google.com/url?sa=D&q=http://www.cs.wisc.edu/~cao/papers/summary-cache/node8.html">
Bloom Filters</A>.</DD>
<BR>


<DT><B><A name="closure"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/closure.h">Closure</A></CODE></B></DT>
<DT><B><A name="callback0"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/callback.h">Callback0</A></CODE></B></DT>
<DT><B><A name="callback1"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/callback.h">Callback1</A></CODE></B></DT>
<DT><B><A name="callback2"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/callback.h">Callback2</A></CODE></B></DT>
<DT><B><A name="callback3"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/callback.h">Callback3</A></CODE></B></DT>
<DT><B><A name="callback4"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/callback.h">Callback4</A></CODE></B></DT>
<DD><B>Abstract classes that provide <CODE>Run()</CODE> methods with
different numbers of arguments.  Useful when you want to ask
another abstraction to do something and then call you back.</B></DD>
<BR>

<DT><A name="dataarray"></A><A name="dataarraybuilder"></A>
    <CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/util/dataarray.h">DataArray/DataArrayBuilder</A></CODE></DT>
<DD>An array of variable-length pieces of data that avoids doing per-element
allocation, and can be easily stored to and retrieved from disk.</DD>
<BR>

<DT><A name="compressedarray"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/coding/compressed-array.h">CompressedArray</A></CODE></DT>
<DD>An immutable array of uint32 values (built using the static
<CODE>CompressedArray::Encode</CODE> method).  It splits the array
into groups of K values.  Within each block of K values, it tries
various encoding schemes, including huffman codes for common values,
differences from the previous value, run-length encoding, toggling of
bits from previous value, etc.  Lookup time is O(K).</DD>
<BR>
</DL>

<H1><A name="threads_and_synchronization">Threads and Synchronization</A></H1>

<DL>
<DT><B><A name="mutex"></A><A name="mutexlock"></A><A name="condvar"></A>
    <CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/synchronization.h">Mutex/MutexLock/CondVar</A></CODE> 
<A href="http://www.corp.google.com/eng/designdocs/mutex/mutex.html">design doc</A>

</B></DT><B></B><DD><B>These classes provide efficient implementations of the synchronization primitives
mutex and condition variable.
</B>
<P>

</P></DD><DT><B><A name="thread"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/thread/thread.h">Thread</A></CODE> 

</B></DT><B></B><DD><B>C++ wrapper around a pthread.
</B><P>

</P></DD><DT><A name="threadpool"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/thread/threadpool.h">ThreadPool</A></CODE> 

</DT><DD>A pool of threads to which you can feed a bunch of closures to be
executed.  When a closure is addded, the next free thread in the
pool will pick it up and run it.
<P>

</P></DD><DT><A name="threadlocal"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/thread/threadlocal.h">ThreadLocal</A></CODE> 

</DT><DD>A thread-local variable -- it keeps track of a different value
per thread.
<P>

</P></DD><DT><A name="producerconsumerqueue"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/thread/pcqueue.h">ProducerConsumerQueue</A></CODE> 

</DT><DT><A name="multislotqueue"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/thread/multislotqueue.h">MultiSlotQueue</A></CODE> 

</DT><DD><CODE>ProducerConsumerQueue</CODE> is a fixed-size
producer-consumer queue.  Useful for handing work off to worker
threads and getting results back, for example.
	  <CODE>MultiSlotQueue</CODE> behaves like a
	  <CODE>ProducerConsumerQueue</CODE>, except that it tries to
	  only allow as many threads to become active as there are
	  CPUs on the machine.  Additional threads are
	  only woken up if entries start to stay in the queue for
	  longer than a specified time interval.
<P>

</P></DD></DL>

<A name="libraries">
</A><H1><A name="general_libraries_and_miscellaneous_routines_classes">General Libraries and Miscellaneous Routines/Classes</A></H1>


<DL>

<DT><A name="protocoldecoder"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/net/proto/protocol-buffer.h"><B>ProtocolBuffer/ProtocolDecoder</B></A></CODE>    <A href="http://www.corp.google.com/eng/howto/infrastructure/protocol-buffer.html">guide</A></DT>
<DD><B>Interfaces for writing out hierarchical data structures into a
	  block of memory.  The data is encoded in such a way that the
	  data structures can easily be extended, so these classes are
	  often used as a way of encoding the results sent back by
	  various servers.</B></DD>
<BR>

<DT><A name="filelinereader"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/base/filelinereader.h">FileLineReader</A></CODE></DT>
<DD>Processes a file, calling an abstract <CODE>InsertFromFile</CODE>
method for each line in the file.  Also supports
<CODE>ReloadIfChanged</CODE> operation, which is useful if you want
your code to periodically pick up new changes from a file that might
get updated.</DD>
<BR>

<DT><A name="cycletimer"></A><A name="elapsedtimer"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/timer.h"><B>CycleTimer/ElapsedTimer/...</B></A></CODE>
</DT><DD><B>Various sorts of timers.</B></DD>
<BR>

<DT><A name="walltime"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/walltime.h">WallTime</A></CODE>
</DT><DD>Routines for manipulating wall times (represented in
seconds as a double).</DD>
<BR>

<DT><A name="strutil"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/strings/strutil.h"><B>strutil.h</B></A></CODE>
</DT><DD><B>Various utility function for manipulating strings.</B></DD>
<BR>

<DT><A name="stringprintf"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/strings/stringprintf.h"><B>StringPrintf</B></A></CODE>
</DT><DD><B><CODE>printf</CODE>-style functions that return STL strings.</B></DD>
<BR>

<DT><B><A name="lang_enc"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/i18n/encodings/lang_enc.h">lang_enc.h</A></CODE></B></DT>
<DD><B>Routines for dealing with different languages and encodings.</B></DD>
<BR>

<DT><B><A name="lang_enc"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/i18n/segmenter/public/universal_segmenter.h">universal_segmenter.h</A></CODE></B></DT>
<DD><B>Support for segmentation in languages lacking spaces between words such
  as Chinese, Japanese, Korean, and Thai.  For a detailed introduction to segmentation, stemming, compound-decomposition, and inflection, see <A href="https://www/eng/i18n/perspective_on_i18n.html">A Perspective on Google's International Search Quality</A>.</B></DD>
<BR>

<DT><B><A name="lang_enc"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/i18n/utf8/letter.h">letter.h</A></CODE></B></DT>
<DD><B>Routines to manipulate alphabetics represented in UTF-8.</B></DD>
<BR>

<DT><A name="hash"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/hash/hash.h"><B>hash.h</B></A></CODE> 
</DT><DD><B>Various hash and fingerprint functions for numbers, strings, etc.</B>
<BR>

</DD><DT><A name="commandlineflags"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/commandlineflags.h"><B>commandlineflags.h</B></A></CODE> 
</DT><DD><B>Support for adding and parsing command-line flags for programs.</B> Look at <A href="http://wiki/Codelab/CommandLineFlags">Command Line Flags Codelab</A> to learn how to use it in your programs.
<BR>

</DD><DT><A name="logging"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/logging.h"><B>logging.h</B></A></CODE>    <A href="http://moma/eng/designdocs/infrastructure/google2-logging.html">design doc</A>
</DT><DD><B>Support for outputting log messages during program execution.</B>
<P>

</P></DD><DT><A name="acmrandom"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/random/acmrandom.h"><B>ACMRandom</B></A></CODE> 
</DT><DD><B>A high-quality, fast random number generator.</B>
<P>


</P></DD><DT><A name="basictypes"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/basictypes.h"><B>basictypes.h</B></A></CODE>
</DT><DD><B>A standard Google header file that defines basic types like
	  <CODE>int32</CODE>, <CODE>int64</CODE>, <CODE>DocId</CODE>, etc.</B>
<P>

</P></DD><DT><A name="initgoogle"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/google.h"><B>google.h/InitGoogle</B></A></CODE> 
</DT><DD><B><CODE>google.h</CODE> contains the <CODE>InitGoogle</CODE> method,
	  which nearly all programs should call on startup to parse command-line
	  arguments, initialize the Google file system, etc.</B>
<P>

</P></DD><DT><A name="googletest"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/testing/base/public/googletest.h"><B>googletest.h</B></A></CODE> 
</DT><DD><B>Functions to compare the actual output of a test to the expected (golden) output.</B>
<P>

</P></DD><DT><A name="scoped_ptr"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/scoped_ptr.h"><B>scoped_ptr.h</B></A></CODE> 
</DT><DD><B><CODE>scoped_ptr</CODE> mimics a built-in pointer except that it guarantees 
deletion of the object pointed to, either on destruction of the scoped_ptr or via
an explicit <CODE>reset()</CODE>. A simple solution for simple needs;
use linked_ptr or shared_ptr if your needs are more complex. Never use
std::auto_ptr as it is forbidden in the C++ style guide (and deprecated
by the first committee draft
<A href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2800.pdf">
N2800</A> of the next C++ standard, informally known as C++0x).</B>
<P>

</P></DD><DT><A name="sysinfo"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/sysinfo.h">sysinfo.h</A></CODE> 
</DT><DD>Misc. routines for determining characteristics of the underlying
	  system (e.g. number of CPUs, physical memory, load average, etc.)
<P>

</P></DD><DT><A name="eventbuffer"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/eventbuf.h">EventBuffer</A></CODE>
</DT><DD>A buffer for recording timestamped events, which can then be used
to understand system behavior or for diagnosing causality when
	  debugging, for example.
<P>
</P></DD><DT><A name="arena"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/arena-inl.h">Arena</A></CODE>
</DT><DD>Allows space and time efficient allocation of objects, if you're
willing to throw them all away at a single shot when you're done with
them.
<P>
</P></DD><DT><A name="objectpool"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/freelist/objectpool.h">ObjectPool</A></CODE>
</DT><DD>Creates a pool of Objects that can then be reused.  If required, 
it will allocate additional objects. 
<P>
</P></DD><DT><A name="freelist"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/freelist/freelist.h">FreeList</A></CODE>
</DT><DD>Provides a free-list of objects that can be used to reduce
calls to new/delete.
<P>
</P></DD><DT><A name="singleton"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/gtl/singleton.h">Singleton</A></CODE>
</DT><DD>Thread-safe controlled access to a single, lazily generated instance 
of a class.
<P>
</P></DD><DT><A name="profiler"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/profiler.h">profiler.o</A></CODE>
</DT><DD>A module that can be linked into a program to provide efficient
	  profiling of a program based on periodic samples of PC
	  values.  Profiles are interpreted via <CODE>bin/pprof</CODE>.
<P>
</P></DD><DT><A name="sim-hash"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/hash/sim-hash.h">sim-hash.h</A></CODE>    <A href="http://moma/eng/designdocs/indexer/simhash.html">design doc</A>
</DT><DD>A module that provides various implementation of similarity-based
	  hash functions.  Used for detecting documents that are
	  approximate duplicates of each other, but are not byte-wise
	  identical (see <A href="http://moma/eng/designdocs/indexer/approxdups.html">approximate
	    dups detection design doc</A>).
<P>
</P></DD><DT><B><A name="exportedvariable"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/stats/io/public/expvar.h">ExportedVariable</A></CODE>
</B></DT><B></B><DD><B>An <CODE>ExportedVariable</CODE> is a means of adding various
	  counters and various other state to a list of data that will
	  be exported from a server for monitoring purposes.
</B><P>

</P></DD><DT><A name="date"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/date/date_date.h">date_date.h</A></CODE>
</DT><DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/date/date_month.h">date_month.h</A></CODE>
</DT><DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/date/date_parse.h">date_parse.h</A></CODE>
</DT><DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/date/date_time.h">date_time.h</A></CODE>
</DT><DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/date/date_weekday.h">date_weekday.h</A></CODE>
</DT><DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/date/date_year.h">date_year.h</A></CODE>
</DT><DT><B><A name="time_support"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/time_support.h">time_support.h</A></CODE></B></DT>
<DD>Various date manipulation routines.  <CODE>find_date</CODE> in
	  <CODE>date_parse.h</CODE> looks
	  for dates in a variety of formats in a string (and no, it
	  won't help your social life, but <CODE>find_timeofday</CODE>
	      will help if you can't find anyone to give you the time
	      of day).</DD>
<BR>

<DT><A name="jniutil"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/base/jniutil.h">jniutil.h</A></CODE></DT>
<DD>A set of utility routines that help when writing Java Native Interface
	  code to interface C++ code to Java.</DD>
<BR>

<DT><A name="statutil"></A><A name="mathutil"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/math/mathutil.h">mathutil.h</A>/<A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/math/statutil.h">statutil.h</A></CODE></DT>
<DD>Various mathematical and statistical routines.</DD>
<BR>

<DT><A name="crc"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/hash/crc.h">CRC</A></CODE></DT>
<DD>The CRC interface computes CRCs on byte strings.  CRCs
(also known as Rabin fingerprints)
are efficient hash functions with guaranteed good statistical properties.
The interface supports CRCs of any size from 8 bits to 128 bits,
and rolling hash functions with any window size.</DD>
<BR>

</DL>

<H1><A name="compression">Compression</A></H1>

<DL>

<DT><A name="zlib"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/third_party/zlib/zlib.h">zlib.h</A></CODE></DT>
<DT><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/third_party/zlib/zlibwrapper.h">ZLib</A></CODE></DT>
<DD><CODE>zlib</CODE> is a programmatic interface to the zlib
	  compression library (used in gzip).  <CODE>ZLib</CODE>,
	  defined in <CODE>zlib/zlibwrapper.h</CODE> is our C++
	  wrapper around this library.</DD>
<BR>

<DT><A name="vcdiff"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/coding/vcdiff.h">VCDiff</A></CODE></DT>

<DD><CODE>VCDiff</CODE> provides differential compression: given
a <CODE>source</CODE> and a <CODE>target</CODE> string, it returns
a compressed encoding <CODE>E</CODE> such that <CODE>target</CODE>
can be reconstructed given <CODE>source</CODE> and <CODE>E</CODE>.</DD>
<BR>

<DT><A name="encoder"></A><A name="decoder"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/coding/coder.h">Encoder/Decoder</A></CODE></DT>
<DD>Support for encoding/decoding byte-aligned data into a memory buffer.</DD>
<BR>

<DT><A name="bitencoder"></A><A name="bitdecoder"></A>
    <CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/coding/bitcoding.h">BitEncoder/BitDecoder</A></CODE></DT>
<DD>Support for encoding/decoding bit-aligned data into a memory buffer.</DD>
<BR>

<DT><A name="huffmancode"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/coding/huffcoding.h">HuffmanCode</A></CODE></DT>
<DD>Builds a Huffman code given a set of symbol frequencies.</DD>
<BR>

<DT><A name="tableencoder"></A><A name="tabledecoder"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/coding/tablecoding.h">TableEncoder/TableDecoder</A></CODE></DT>
<DD>Classes for efficiently encoding and decoding prefix-free codes (such as
Huffman codes) via lookup tables, using <CODE>BitDecoder/BitEncoder</CODE>.</DD>
<BR>

<DT><A name="zippy"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/zippy/zippy.h">Zippy</A></CODE></DT>
<DD>Lightweight compression algorithm designed for speed (ratios comparable to LZO).</DD>
<BR>

<DT><A name="BMDiff"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/coding/bmdiff.h">BMDiff</A></CODE></DT>
<DD>Bentley/McIlroy diff algorithm (Data compression for long common strings). Not strictly a compressor a la VCDiff,
but is 4x faster than VCDiff at encoding diffs.</DD>
<BR>

</DL>

<H1><A name="math">Math</A></H1>

<DL>

<DT><A name="gmatrix"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/gmatrix/gmatrix-inl.h">GMatrix</A></CODE> is a library of templatized matrix classes.
See the <A href="http://www.corp.google.com/eng/howto/gmatrix/index.html">GMatrix Documentation</A>
for details.</DT>
<BR>

<DT><A name="conjgrad-inl"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/gmatrix/conjgrad-inl.h">conjgrad-inl.h</A></CODE> contains conjugate gradient algorithms
for solving systems of linear equations and for the local minimization
of nonlinear functions.</DT>

</DL>

<H1><A name="stats">Stats</A></H1>

<DL>
<DT><A name="basicstat"></A><A name="multilevelstat"></A><A name="minutehourstat"></A>
    <CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/stats/io/public/stats.h">BasicStat/MultiLevelStat/MinuteHourStat/...</A></CODE></DT>
<DD>Various counters that make it easy to keep track of statistics.
	  The MinuteHourStat is an easy way of keeping track of the
	  count of something over the past minute, the past hour, and
	  since program startup.  Used to maintain stats in lots of
	  our servers (mixers, balancers, etc.)</DD>
<BR>
<DT><A name="decayingstat"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/stats/base/decayingstat.h">DecayingStat</A></CODE></DT>
<DD>An exponentially decaying counter.</DD>
<BR>
<DT><A name="histogram"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/stats/io/public/histogram.h">Histogram</A></CODE></DT>
<DD>A class that maintains histogram information for non-negative
values.</DD>
<P>
</P></DL>


<H1><A name="fileio"></A><A name="file_input_output_abstractions">File Input/Output Abstractions</A></H1>

<DL>
<DT><B><A name="file"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/base/file.h">File</A></CODE></B></DT>
<DT><B><A name="inputbuffer"></A><A name="outputbuffer"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/base/inputbuffer.h">InputBuffer</A></CODE>/<CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/base/outputbuffer.h">OutputBuffer</A></CODE></B></DT>
<DT><B><A name="recordreader"></A><A name="recordwriter"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/base/recordio.h">RecordReader/RecordWriter</A></CODE></B></DT>
<DT><B><A href="http://moma/eng/designdocs/infrastructure/google2file.html">File
	    overview design doc</A> (outdated)
<BR><A href="http://moma/eng/howto/infrastructure/recordio.html">RecordIO howto</A></B></DT>

<DD><B>The basic File abstraction is used in nearly all Google code.  The
reading and writing interface has implementations for both regular
local files, bigfiles, and for remote regular and bigfiles that are
resident on other machines.  The kind of file that is created depends
on the filename given to the constructor
(e.g. <CODE>"/tmp/smallfile"</CODE>,
<CODE>"/bigfile/mybigfile"</CODE>,
<CODE>"suqq12:/bigfile/mybigfile"</CODE>, etc.)
<P>
<CODE>InputBuffer</CODE> and <CODE>OutputBuffer</CODE> are used for
wrapping memory-buffers around <CODE>File</CODE> objects.
</P></B><P><B>
<CODE>RecordReader</CODE> and <CODE>RecordWriter</CODE> are used for
writing arbitrary variable-length records of data to files in a way
that deals nicely with data corruption (often caused by bad memory,
bad disks, bad networks, etc.). The read interface automatically
detects corruptions and skips corrupted records.  Therefore any errors
in the data are turned into atomic deletion of records from the
neighborhood of the error.  Nearly all intermediate data computed
during indexing is maintained in RecordIO form.</B></P></DD>

<BR>
<DT><A name="checkpointwriter"></A><A name="checkpointreader"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/base/checkpointing.h">CheckpointWriter/CheckpointReader</A></CODE></DT>

<DD>Facilities for writing checkpoints that describe the state of a
computation, and for reading back and restoring the state when a
program restarts.  Used extensively in the ripper and the indexing
process to make most of the pieces of indexing restartable.</DD>
<BR>
<DT><A name="checksumcomputer"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/base/checksummer.h">ChecksumComputer</A></CODE></DT>
<DD>An interface for computing checksums of blocks of memory or files of data.</DD>
<BR>
<DT><A name="bundle"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/bundle/bundle.h">Bundle</A></CODE></DT>
<DT><A name="bundlewriter"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/bundle/bundlewriter.h">BundleWriter</A></CODE></DT>
<DD>A <CODE>Bundle</CODE> is a file that contains a bunch of
independent sections.  A directory that maps from integer keys to
ranges within the file is kept at the tail of the file.  The in-memory
index uses this to put together a bunch of separate data (index data,
lexicon, various restricts, etc.) into a single file.</DD>
<BR>
<DT><A name="filebackedbuffer"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/util/filebackedbuffer.h">FileBackedBuffer</A></CODE></DT>
<DD>A buffer that is normally all in memory, but which can be spilled
to disk if it becomes large.</DD>
</DL>


<H1><A name="networking"></A><A name="networking_abstractions">Networking Abstractions</A></H1>

<DL>
<DT><A name="stubby"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/net/rpc/rpc.h"><B>Stubby</B></A></CODE>
</DT><DT><A name="protocolbuffer"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/net/proto/protocol-buffer.h"><B>ProtocolBuffer</B></A></CODE>
</DT><DT><A name="httpserver"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/net/http/httpserver.h"><B>HTTPServer</B></A></CODE>
</DT><DT><A name="iobuffer"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/iobuffer/iobuffer.h"><B>IOBuffer</B></A></CODE>
</DT><DT><A name="selectserver"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/net/base/selectserver.h"><B>SelectServer</B></A></CODE>

</DT><DD>
    <B>The primary RPC system at Google is Stubby and its most recent
    implementation is Stubby2.</B> The Stubby1 and Stubby2 implementations are
    compatible with one another and similar in their usage.  Protocol buffers
    are used by Stubby; they provide an extensible way to marshal and unmarshal
    data for transport over the network.

    <P>
    HTTPServer implements an extensible HTTP server that can be used both to
    process requests from the Internet and to provide server diagnostics within
    the company.

</P></DD><DD>
    The following documents describe these systems and give examples of their
    use:

<UL>
<LI><A href="http://wiki/twiki/bin/view/Main/Stubby2"><B>Stubby2 description</B></A>
</LI><LI><A href="http://www/eng/howto/infrastructure/stubby.html"><B>Stubby description</B></A>
</LI><LI><A href="http://www.corp.google.com/eng/howto/infrastructure/protocol-buffer.html"><B>Protocol Buffer guide</B></A>
</LI><LI><A href="http://moma/eng/howto/infrastructure/httpserver.html"><B>HTTPServer howto</B></A>

</LI></UL>

    <P>
    IOBuffer and SelectServer underlie our older, obsolescent networking
    infrastructure, but they are still commonly found in Google code.  There
    are many other network-related classes, most of which can be found beneath
    <CODE>google3/net</CODE>.

    </P><P>
    </P></DD><DD>
    An obsolete RPC system called
    <A href="http://moma/eng/designdocs/infrastructure/rpcnetworking.html">
    ClientRPC</A>
    is still in use in a few places in Google code.  ClientRPC is not
    maintained and should not be used in new code.  To convert such code to
    Stubby, see:
    <A href="http://wiki.corp.google.com/twiki/bin/view/Main/ClientRPCtoStubbyMigration">
    Migrating from ClientRPC to Stubby</A>.

</DD></DL>


<H1><A name="stringmatching"></A><A name="string_matching">String Matching</A></H1>

<DL>
<DT><A name="regexp"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/regexp/regexp.h"><B>RegExp</B></A></CODE>
</DT><DD><B>Convenient C++ wrapper around the pcre regular expression library.
    Allows easy one-line regexp matches and extractions.</B>
Quoting from its header file, however: "If you are handling regular
expressions specified by (external or internal) users, rather than
hard-coded ones, you should be using RE2, which uses an alternate
implementation that avoids these issues.  See
<A href="http://go/re2quick">http://go/re2quick</A>."

<P>
</P></DD><DT><A name="stringmatcher"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/strings/io/stringmatch.h">StringMatcher</A></CODE>
</DT><DD>Class for doing fast matching of document words against a bunch of
	  patterns (similar to fgrep, but faster).
Used for implementing various filters, such as our porn filter.

<P>
</P></DD><DT><A name="stringrewriter"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/strings/stringrewriter.h">StringRewriter</A></CODE>    <A href="http://moma/eng/designdocs/infrastructure/stringrewriter-new.html">design doc</A>
</DT><DD>Class for doing string rewriting based on regular expressions.
	  Used to rewrite some kinds of URLs during the crawl (to
	  remove session IDs, for example).
<P>

</P></DD><DT><A name="editdistance"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/strings/editdistance.h">EditDistance</A></CODE>  
</DT><DD>A general edit distance class. You can override the "skip
to next" method to skip by bytes, utf8 chars, or other units, to perform edit distance 
calculations on characters, words, etc.
<P>

</P></DD><DT><A name="levenshteindistance"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/list/edit_distance-inl.h">LevenshteinDistance</A></CODE>
</DT><DD>Efficient implementation of edit distance between two sequences,
assuming the three standard edit operations: insert, delete, and replace.
Space is linear if you don't need to reconstruct the optimal alignment.
Time is linear if you're able to provide a fixed upper bound
on the permitted inter-sequence distance.

<P>

</P></DD><DT><A name="spellutil"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/spelling/spellutil.h">Spellutil</A></CODE>   
</DT><DD>EditDistance() is the edit distance function used in spelling correction.
<P>

</P></DD></DL>


<H1><A name="web"></A><A name="document_web_http_html_specific_classes">Document/Web/HTTP/HTML Specific Classes</A></H1>

<DL>
<DT><A name="url"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/webutil/url/url.h"><B>URL</B></A></CODE> 

</DT><DD><B>A representation of a URL.  Supports various operations to get and
set various pieces of the URL (e.g. <CODE>host()</CODE>,
<CODE>path()</CODE>, etc). (Please note that this takes ~10KB of memory
for the current <CODE>kMaxUrlLengths</CODE> of 2KB, and this number may go
up).</B>
<P>

</P></DD><DT><A name="hostname"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/webutil/url/hostname.h">HostName</A></CODE> 
</DT><DD>Routines for manipulating hostnames and pulling
out things like top-level domains (TLDs), etc.

<P>
</P></DD><DT><A name="ipaddress"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/net/util/ipaddress.h">IPAddress/SocketAddress/IPRange</A></CODE> 

</DT><DD>IPv4/IPv6-agnostic abstractions of IP addresses, socket addresses (IP/port
pair), and IP subnets (IP address plus mask length). Also contains functions for
converting these objects to and from strings, IPv6-to-IPv4 address coercion for
interfacing with IPv4-only code, ordering and hashing of IP addresses, and
packed representations for space-critical protobuffers. Replaces the older
IPAddress typedef, now renamed to
<A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/net/util/oldipaddress.h">OldIPAddress</A>.

<P>
</P></DD><DT><A name="urlmatcher"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/webutil/urlutil/urlmatcher.h">URLMatcher</A></CODE>
</DT><DD>Class for doing matching of a url against a bunch of patterns.
Used for implementing various filters in gws and in the indexing
system (e.g. badurls)

<P>
</P></DD><DT><A name="htmlutils"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/webutil/html/htmlutils.h">HtmlUtils</A></CODE>
</DT><DD>Provides a few functions useful for processing HTML, such as
	  unescaping, handling of meta tags, etc.

<P>
</P></DD><DT><A name="htmltagtype"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/webutil/html/htmltagtype.h">HtmlTagType</A></CODE>
</DT><DD>A collection of useful properties about HTML tag types, such as
    whether they're implicitly closed, block-level or inline, etc.

<P>
</P></DD><DT><A name="httputils"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/webutil/http/httputils.h">HttpUtils</A></CODE>
</DT><DD>Provides a few functions useful for dealing with HTTP,
     particularly for storing and retrieving HTTP headers.
<P>
</P></DD><DT><A name="document"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/repository/base/document.h"><B>Document</B></A></CODE>
</DT><DT><A name="document-iterator"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/repository/util/document-iterator.h">TestDocumentIterator</A></CODE>
</DT><DT><A name="handler"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/repository/handler/handler.h">Handler</A></CODE>
</DT><DT><A name="parsehandler"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/repository/parsers/base/handler-parser.h">ParseHandler</A></CODE>
</DT><DT><A name="ripper"></A><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/repository/ripper/ripper.cc"><CODE>ripper.cc</CODE> (ripper main program)</A> <I>No longer in widespread use. See bold text below.</I>
</DT><DD>
          A <CODE>Document</CODE> is the representation of a document stored
	  in our repository.  
          A <CODE>Handler</CODE> is something that
	  operates over a document.  Documents are typically processed
	  by specifying one or more handler command-line arguments to
	  the ripper program, which iterates over documents in a
	  repository on disk.  A <CODE>ParseHandler</CODE> is a special kind of
	  <CODE>Handler</CODE> that breaks a document down into
	  individual pieces and invokes callbacks for each element in
	  the document (e.g. <CODE>AddTerm</CODE>,
	  <CODE>AddNumber</CODE>, <CODE>BeginAnchor</CODE>, etc.).

	  <P>See <A href="http://www.corp.google.com/eng/howto/ripper/ripper-intro.html">An
	    Introduction to the Ripper</A> for more info. <I>Out of date. See bold text below.</I>
          </P><P>A <CODE>TestDocumentIterator</CODE> is used by some tests and tools
	  as an alternative to the ripper framework.  It can parse a variety of
          storage formats and supports filtering.

          </P><P><B>Instead of the ripper, we now generally use <A href="https://www.corp.google.com/eng/howto/exercises.html#parsehandler">MapReduce with the parse handler</A>.</B>

</P><P>
</P></DD><DT><A name="robotsparser"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/googlebot/util/robotstxt/robots.h">RobotsParser</A></CODE>
</DT><DD>A parser for <CODE>robots.txt</CODE> files.
<P>
</P></DD><DT><A name="duphosts"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/webutil/urlutil/duphosts.h">DuplicateHostDB (duphosts)</A></CODE>
</DT><DD>A class for maintaining a set of clusters of hosts that have identical content
	  (e.g. <CODE>www.yahoo.com</CODE> and
	  <CODE>yahoo.com</CODE>).  This is used heavily during the crawling
	  and indexing process.
<P>
</P></DD><DT><A name="canonicalurl"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/webutil/urlutil/canonicalurl.h">CanonicalURL</A></CODE>
</DT><DD>A class for applying duphost rules and URL rewriting rules to a
	  URL to get it into its canonical form.  URLs in our index
	  are stored in their canonical form, so if you're processing
	  a bunch of URLs that you got from somewhere else, you'll
	  want to use a <CODE>CanonicalURL</CODE> object to convert
	  the URLs to the canonical form.

<P>
</P></DD><DT><A name="sitechunker"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/webutil/sitechunker/sitechunker.h">sitechunker</A></CODE> 
</DT><DD>Routines for identifying sites for URLs.
Site names are the same as domain names, except for large hosting sites
which are split according to subtrees.
Uses patterns defined in
<CODE><A href="file:///home/build/google3/googledata/quality/sitechunker.patterns">
googledata/quality/sitechunker.patterns</A></CODE>.

<P>
</P></DD><DT><A name="htmlgenerator"></A>
<CODE>
<A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/webutil/io/htmlgenerator.h">HTMLGenerator</A>
</CODE>
</DT><DD>Mechanism for registering html-generating callbacks to be invoked when
    a particular URI is sent to an HTTP server.  Used to generate HTML
    status pages for various servers like the mixer and the balancer.

<P>
</P></DD><DT><A name="ares"></A><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/third_party/ares/ares.h"><CODE>ares.h</CODE> - asynchronous DNS
	      resolution library</A>
</DT><DT><A name="dnsresolver"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/net/base/dnsresolver.h">DNSResolver</A></CODE>
</DT><DD>A third-party library for doing asynchronous DNS resolution.
<CODE>DNSResolver</CODE> is our wrapper on top of this
library that is used within the crawling system.
<P>
</P></DD></DL>


<H1><A name="index"></A><A name="index_specific_abstractions">Index-specific Abstractions</A></H1>

<P>
Various Google-specific abstractions or data structures that are
      fundamental to indexing or query serving:
</P>

<DL>
<DT><A name="indexdefs"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/indexdefs.h">IndexDefs</A></CODE>
</DT><DD>Various definitions of constants used in representing index data.
<P>

</P></DD><DT><A name="indexreader"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/reader/indexreader.h">IndexReader</A></CODE>
</DT><DT><A name="index_andreader"></A><CODE>  <A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/reader/indexreader.h">Index_AndReader</A></CODE>
</DT><DT><A name="index_orreader"></A><CODE>  <A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/reader/indexreader.h">Index_OrReader</A></CODE>
</DT><DT><A name="index_notreader"></A><CODE>  <A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/reader/indexreader.h">Index_NotReader</A></CODE>
</DT><DT><A name="index_streamreader"></A><CODE>  <A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/reader/indexreader.h">Index_StreamReader</A></CODE>
</DT><DT><CODE>  ...</CODE>
</DT><DD>Various abstractions for processing index data.
<P>

</P></DD><DT><A name="abstractindex"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/reader/abstractindex.h">AbstractIndex</A></CODE>
</DT><DT><A name="fullindex"></A><CODE>  <A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/fullindex/fullindex.h">FullIndex</A></CODE>
</DT><DT><A name="diskindex"></A><CODE>  <A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexserving/server/diskindex.h">DiskIndex</A></CODE>
</DT><DT><A name="microshardindex"></A><CODE>  <A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexserving/server/microindex.h">MicroshardIndex</A></CODE>
</DT><DT><A name="realtimeindex"></A><CODE>  <A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/rtserver/indexserving/rtindex.h">RealtimeIndex</A></CODE>
</DT><DD>An abstraction for interacting with index files, and various
implementations for different representations of index data.
<P>

</P></DD><DT><A name="anchortext"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/anchortext.h">AnchorText</A></CODE>
</DT><DD><CODE>AnchorText</CODE> holds information about a single anchor
	  (including from docid, to docid, kind of anchor, anchor text, IP address of
	  source, etc.)
<P>

</P></DD><DT><A name="partialindexer"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/writer/partialindexer.h">PartialIndexer</A></CODE>
</DT><DT><A name="microlexicon"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/sortedmap/microlexicon/microlexicon.h">MicroLexicon</A></CODE>
</DT><DT><A name="microlexiconbuilder"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/sortedmap/microlexicon/microlexbuilder.h">MicroLexiconBuilder</A></CODE>

</DT><DD>Various abstractions and implementations used during index building.
<P>
</P></DD><DT><A href="http://moma/eng/designdocs/indexer/blockcompressedindex.html">Compressed Index Format design doc</A>
</DT><DT><A name="indexblockformat"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/block/indexblockfmt.h">IndexBlockFormat</A></CODE>
</DT><DT><A name="indexblockencoder"></A><CODE>  <A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/block/indexblockencoder.h">IndexBlockEncoder</A></CODE>
</DT><DT><A name="indexblockdecoder"></A><CODE>  <A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/indexer/block/indexblockdecoder.h">IndexBlockDecoder</A></CODE>
</DT><DD>The basic classes responsible for encoding and decoding index
	  data.
</DD></DL>

<H1><A name="utility_programs">Utility Programs</A></H1>

<P>
These aren't abstractions themselves, but help you deal with the
abstractions.
</P>

<DL>
  <DT><A name="fileutil"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/file/util/fileutil.cc"><B>fileutil</B></A></CODE>
  </DT><DT><CODE><A href="http://www.corp.google.com/eng/howto/google3/fileutil.html">(fileutil howto)</A></CODE>
  </DT><DD> <B>Lets you access and operate on bigfiles/gfs files, much like
       unix file utils like cat, cp, rm, etc.
       </B><P>

  </P></DD><DT><A name="gfscp"></A><CODE><A href="http://www/eng/designdocs/gfs/gfscp.html">gfscp</A></CODE>
  </DT><DT><CODE><A href="http://www/eng/howto/gfs/usage_tips.html#gfscp">(gfs usage tips)</A></CODE>
  </DT><DD> Lets you reliably copy GFS files between GFS cells using workqueue jobs.
       <P>
       
  </P></DD><DT><A name="codex"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/tools/codex/codex.cc"><B>codex</B></A></CODE>
  </DT><DD><B> Lets you print binary files in human-readable format.  Examples
       are sstables, posting lists, etc.
       </B><P>

  </P></DD><DT><A name="anticodex"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/tools/anticodex.cc">anticodex</A></CODE>
  </DT><DD> Lets you create binary files from a text file specification.
       This lets you keep data files in p4 in a human-editable format,
       then convert them to binary so your programs can use them
       easily.
       <P>

  </P></DD><DT><A name="testutils_tool"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/repository/util/testutils_tool.cc">testutils_tool</A></CODE>
  </DT><DD> Allows you to perform some simple operations on a set of documents,
       for example converting them to ".html" files or viewing them in a browser.
       <P>

</P></DD><DT><A name="sorted-map-retrieve"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/tools/sorted-map-retrieve.cc">sorted-map-retrieve</A></CODE>
</DT><DT><A name="sstable-retrieve"></A><CODE><A href="https://www.corp.google.com/cgi-bin/docfinder.cgi?file=//depot/google3/util/tools/sstable-retrieve.cc">sstable-retrieve</A></CODE>
</DT><DT>
</DT><DD>Specialized alternatives to codex for looking up single keys or dumping entire SSTables or SortedMaps.  Typical calling sequences are given in source file at <CODE>tools/sstable-retrieve.cc</CODE> and <CODE>tools/sorted-map-retrieve.cc</CODE>.
<P>
</P></DD></DL>

<SCRIPT type="text/javascript"> var gaJsHost = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.'); document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E")); </SCRIPT><SCRIPT src="./Overview of Important Abstractions and Data Structures_files/ga.js" type="text/javascript"></SCRIPT> <SCRIPT type="text/javascript"> var pageTracker = _gat._getTracker('UA-1067920-1'); _gat.lc='https://ssl.google-analytics.com/__utm.gif'; pageTracker._initData(); pageTracker._trackPageview(); </SCRIPT> 

</BODY></HTML>